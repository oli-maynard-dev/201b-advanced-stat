---
title: STAT 201B HW7
subtitle: Oliver Maynard
format:
  pdf:
    documentclass: article
    margin-left: 30mm
    margin-right: 30mm
    toc: false
  html:
    theme: cosmo
    css: ../styles.css
    toc: false
    code-copy: true
    code-block-background: true
execute:
  freeze: auto
---
\newpage
# Problem 4c
```{python}
import numpy as np
import matplotlib.pyplot as plt

# Set random seed for reproducibility
np.random.seed(42)

# Parameters
mu = 10
sigma_squared = 4
sigma = np.sqrt(sigma_squared)
alpha = 9
beta = 13
B = 1000 

# Rejection sampling algorithm
samples = []

while len(samples) < B:
    # Generate proposal from Normal(mu, sigma^2)
    theta_star = np.random.normal(mu, sigma)
    
    # Accept if alpha < theta_star < beta
    if alpha < theta_star < beta:
        samples.append(theta_star)

samples = np.array(samples)

# Create histogram
plt.figure(figsize=(10, 6))
plt.hist(samples, bins=30, density=True, alpha=0.7, color='blue', edgecolor='black')
plt.xlabel('theta')
plt.ylabel('Density')
plt.title(f'Histogram of {B} Samples from Truncated Normal({mu}, {sigma_squared}) on ({alpha}, {beta})')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()
```